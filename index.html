<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador Examen - FMCC</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        .card { background: white; width: 100%; max-width: 700px; padding: 40px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); text-align: center; position: relative; }
        h1 { color: #2c3e50; font-size: 28px; margin-bottom: 10px; }
        h2 { color: #7f8c8d; font-size: 18px; font-weight: normal; margin-bottom: 30px; }
        
        /* Grid de botones */
        .grid-menu { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px; }
        
        .btn { padding: 15px; border: none; border-radius: 8px; font-size: 1.1em; cursor: pointer; transition: 0.2s; font-weight: bold; color: white; width: 100%; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn:active { transform: scale(0.98); }

        .btn-theme { background-color: #34495e; }
        .btn-theme:hover { background-color: #2c3e50; }
        
        .btn-general { background-color: #2980b9; grid-column: span 2; font-size: 1.2em; }
        
        /* Bot√≥n especial para las fijas */
        .btn-fijas { background-color: #e74c3c; grid-column: span 2; font-size: 1.3em; border: 2px solid #c0392b; animation: pulse 2s infinite; }
        .btn-fijas:hover { background-color: #c0392b; }
        
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(231, 76, 60, 0); } 100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0); } }

        /* Bot√≥n de Salir (X) */
        .btn-exit { position: absolute; top: 20px; right: 20px; background: #ecf0f1; color: #7f8c8d; border: none; font-size: 14px; padding: 8px 15px; border-radius: 20px; cursor: pointer; font-weight: bold; }
        .btn-exit:hover { background: #bdc3c7; color: #2c3e50; }

        /* Estilos examen */
        .progress { color: #7f8c8d; margin-bottom: 20px; font-size: 0.9em; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; }
        .question-box { font-size: 1.35em; font-weight: 600; color: #2c3e50; margin: 30px 0; line-height: 1.4; min-height: 80px; display: flex; align-items: center; justify-content: center; }
        
        input[type="text"] { width: 80%; padding: 15px; font-size: 1.2em; border: 2px solid #bdc3c7; border-radius: 8px; margin-bottom: 20px; outline: none; transition: 0.3s; text-align: center; }
        input[type="text"]:focus { border-color: #3498db; box-shadow: 0 0 8px rgba(52, 152, 219, 0.3); }

        .btn-action { background-color: #3498db; width: auto; padding: 15px 40px; }
        .btn-next { background-color: #2c3e50; display: none; width: auto; padding: 15px 40px; margin-top: 20px; }

        .feedback { margin-top: 20px; padding: 20px; border-radius: 8px; display: none; text-align: left; }
        .feedback.correct { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; text-align: center; }
        .feedback.wrong { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .correct-answer-text { font-weight: bold; margin-top: 5px; display: block; font-size: 1.1em; color: #c0392b; }

        .score-final { font-size: 4em; font-weight: 800; color: #2c3e50; margin: 10px 0; }
        .hidden { display: none; }

        /* Estilo para la esquina superior izquierda */
        .github-corner {
            position: absolute;
            top: 2px;
            left: 20px;
            text-align: left;
            z-index: 1000;
        }

        .github-corner p {
            margin: 0 0 2px 0;
            font-size: 0.8em;
            color: #7f8c8d;
            font-weight: 600;
        }

        @media (max-width: 600px) {
            .github-corner p { display: none; }
        }

        /* --- NUEVOS ESTILOS PARA EL MODO PERSONALIZADO --- */
        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
            text-align: left;
        }

        .topic-label {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            font-weight: bold;
            color: #2c3e50;
            border: 2px solid transparent;
        }

        .topic-label:hover { background: #dfe6e9; }

        /* Cuando el checkbox (oculto) est√° marcado, cambiamos el estilo del label */
        .topic-check:checked + .topic-label {
            background-color: #d6eaf8;
            border-color: #3498db;
            color: #2980b9;
        }

        .topic-check { display: none; } /* Ocultamos el checkbox feo */
    </style>
</head>
<body>
    <div class="github-corner">
        <h4>¬øTe es √∫til? ‚≠ê en GitHub</h4>
        <a class="github-button" 
           href="https://github.com/aledelgadoo/test-examen-fmcc" 
           data-color-scheme="no-preference: light; light: light; dark: dark;" 
           data-icon="octicon-star" 
           data-size="large" 
           data-show-count="true" 
           aria-label="Star on GitHub">
           Star
        </a>
    </div>
    <script async defer src="https://buttons.github.io/buttons.js"></script>

<div class="card" id="start-screen">
    <h1>Simulador de Examen FMCC</h1>
    <h2>Elige modo de estudio:</h2>
    
    <div class="grid-menu">
        <button class="btn btn-fijas" onclick="startExam('fijas')">PREGUNTAS FIJAS</button>
        
        <button class="btn btn-theme" onclick="startExam('1')">Tema 1</button>
        <button class="btn btn-theme" onclick="startExam('2')">Tema 2</button>
        <button class="btn btn-theme" onclick="startExam('3')">Tema 3</button>
        <button class="btn btn-theme" onclick="startExam('4')">Tema 4</button>
        <button class="btn btn-theme" onclick="startExam('5')">Tema 5</button>
        <button class="btn btn-theme" onclick="startExam('6')">Tema 6 y 7</button>
        
        <button class="btn btn-theme" style="background-color: #8e44ad; grid-column: span 2;" onclick="openCustomMenu()">üéõÔ∏è MODO PERSONALIZADO (Elige temas)</button>

        <button class="btn btn-general" onclick="startExam('all')">üé≤ EXAMEN GENERAL (Aleatorio)</button>
    </div>
</div>

<div class="card hidden" id="custom-screen">
    <button class="btn-exit" onclick="closeCustomMenu()">‚úï Volver</button>
    <h1>Configura tu Examen</h1>
    <h2>Selecciona los temas que quieres mezclar:</h2>
    
    <div class="checkbox-grid" id="topics-container">
        </div>

    <button class="btn btn-action" onclick="startCustomExam()">¬°Empezar Test Personalizado!</button>
</div>

<div class="card hidden" id="quiz-screen">
    <button class="btn-exit" onclick="returnToMenu()">‚úï Men√∫</button>

    <div class="progress" id="progress-text">...</div>
    <div class="question-box" id="question-text">...</div>
    
    <input type="text" id="user-input" placeholder="Escribe tu respuesta..." autocomplete="off">
    <br>
    <button class="btn btn-action" id="btn-action" onclick="checkAnswer()">Comprobar</button>
    
    <div id="feedback-box" class="feedback">
        <span id="feedback-msg"></span>
        <span id="real-answer" class="correct-answer-text"></span>
    </div>

    <button class="btn btn-next" id="btn-next" onclick="nextQuestion()">Siguiente ‚û°</button>
</div>

<div class="card hidden" id="result-screen">
    <h1>Resultados</h1>
    <div class="score-final" id="score-display">0</div>
    <p id="message-display"></p>
    <button class="btn btn-action" onclick="returnToMenu()">Volver al Men√∫</button>
</div>

<script>
    const database = [
        {t: 'fijas', q: "La diferencia entre las ventas totales actuales y el mercado potencial absoluto se denomina", a: "EXPANSI√ìN DE LA DEMANDA"},
        {t: 'fijas', q: "¬øQu√© m√©todos de previsi√≥n de demanda se emplean para realizar estimaciones a largo plazo?", a: "DELPHI"},
        {t: 'fijas', q: "Si existen grandes fluctuaciones en los datos hist√≥ricos de la demanda, ¬øqu√© m√©todo de previsi√≥n de demanda a corto plazo no se puede emplear?", a: "AJUSTE DE FUNCIONES"},
        {t: 'fijas', q: "Cuando se analizan los datos hist√≥ricos de la demanda de un producto se aprecia que en los dos √∫ltimos periodos se ha producido un incremento significativo de la demanda, ¬øqu√© tipo de m√©todo de previsi√≥n de demanda se debe emplear?", a: "BANDA DE ALISADO 3 O COEFICIENTE DE ALISAMIENTO TENDENTE A 1"},
        {t: 'fijas', q: "¬øC√≥mo se denomina el enfoque de marketing que se centra en las caracter√≠sticas de los productos?", a: "MIOP√çA DE MARKETING"},
        {t: 'fijas', q: "¬øEn qu√© etapa del ciclo de vida del producto se consiguen las m√°ximas ventas?", a: "MADUREZ"},
        {t: 'fijas', q: "¬øC√≥mo se denomina el m√©todo para fijar los precios que se considera objetivo y justo?", a: "BASADO EN EL COSTE"},
        {t: 'fijas', q: "¬øC√≥mo se denomina el m√©todo para fijar los precios que analiza a los consumidores?", a: "VALOR PERCIBIDO"},
        {t: 'fijas', q: "Describa un canal de distribuci√≥n indirecto largo:", a: "FABRICANTE - MAYORISTA - MINORISTA - CONSUMIDOR FINAL"},
        
        {t: '1', q: "En la definici√≥n de Marketing, ¬øcu√°l es la palabra clave a partir de la cual se desarrollan relaciones de Marketing?", a: "INTERCAMBIO"},
        {t: '1', q: "¬øC√≥mo definir√≠a el Marketing como ACCI√ìN?", a: "CONQUISTA DE MERCADOS"},
        {t: '1', q: "¬øQu√© concepto es tratado en el Marketing como ilimitado?", a: "DESEOS"},
        {t: '1', q: "Llamar a clientes para medir calidad percibida es Marketing...", a: "MARKETING RELACIONAL"},
        {t: '1', q: "¬øDe qu√© est√° compuesta la orientaci√≥n al mercado?", a: "ORIENTACI√ìN AL CONSUMIDOR M√ÅS ORIENTACI√ìN A LA COMPETENCIA"},
        {t: '1', q: "¬øEl Marketing de relaciones es antes o despu√©s del intercambio?", a: "DESPU√âS"},
        {t: '1', q: "¬øEstrategia de Marketing relacionada con escaso √©nfasis en servicio al cliente?", a: "MARKETING TRANSACCIONAL"},
        {t: '1', q: "Estar en m√°s puntos de venta que competidores y a menor precio es estrategia de:", a: "LIDERAZGO EN COSTES"},
        {t: '1', q: "A nivel de negocio, ¬øqu√© tipo de estrategia de marketing se desarrolla?", a: "MARKETING ESTRAT√âGICO"},
        {t: '1', q: "En Marketing Estrat√©gico, ¬øqu√© funci√≥n considera el concepto analizado ampliamente?", a: "DELIMITACI√ìN DEL MERCADO RELEVANTE"},
        {t: '1', q: "El an√°lisis de fortalezas y debilidades se realiza sobre:", a: "INTERNAMENTE A LA ORGANIZACI√ìN Y A LA COMPETENCIA"},
        {t: '1', q: "¬øLa fijaci√≥n de objetivos es antes o despu√©s de la estrategia?", a: "ANTES DE F√ìRMULAR LA ESTRATEGIA"},
        {t: '1', q: "¬øLas relaciones p√∫blicas y el poder a qu√© tipo de marketing hacen referencia?", a: "MEGAMARKETING"},
        {t: '1', q: "Acuerdo con Administraci√≥n P√∫blica para reformar un parque es Marketing...", a: "MARKETING SOCIAL"},
        {t: '1', q: "Colaborar en lucha contra tabaco a cambio de licencia comercial es Marketing...", a: "MEGAMARKETING"},
        {t: '1', q: "Las alianzas estrat√©gicas hacen referencia a la funci√≥n de:", a: "MARKETING RELACIONAL"},
        {t: '1', q: "¬øCu√°les son las variables del marketing-mix?", a: "PRODUCTO, PRECIO, DISTRIBUCI√ìN Y COMUNICACI√ìN"},
        {t: '1', q: "¬øCu√°les son las variables del marketing operativo?", a: "PRODUCTO, PRECIO, DISTRIBUCI√ìN Y COMUNICACI√ìN"},
        {t: '1', q: "Conceptos vinculados al marketing como cultura:", a: "ORIENTACI√ìN AL MERCADO Y MARKETING DE RELACIONES"},
        {t: '1', q: "Concepto mental sobre la posici√≥n de una marca en relaci√≥n a otras:", a: "POSICIONAMIENTO COMPETITIVO"},
        {t: '2', q: "¬øQu√© teor√≠a sobre el comportamiento de compra considera que los individuos compran los productos que maximizan su utilidad?", a: "ECON√ìMICA"},
        {t: '2', q: "¬øQu√© teor√≠a sobre el comportamiento de compra se aplica preferentemente para el dise√±o de productos, envases y mensajes publicitarios?", a: "PSICOANAL√çTICA"},
        {t: '2', q: "¬øQu√© concepto de la teor√≠a del aprendizaje se califica como positivo si la experiencia de compra ha sido satisfactoria y negativo en caso contrario?", a: "FORTALECIMIENTO"},
        {t: '2', q: "La forma en que el consumidor recoge, procesa e interpreta los est√≠mulos sensoriales se denomina:", a: "PERCEPCI√ìN"},
        {t: '2', q: "La predisposici√≥n general que dirige el comportamiento de compra de los individuos se denomina:", a: "MOTIVACI√ìN"},
        {t: '2', q: "En el modelo de comportamiento de compra individual, ¬øla personalidad es una variable...?", a: "VARIABLE INTERNA"},
        {t: '2', q: "El estado afectivo del individuo ligado a su disposici√≥n a obrar de cierta forma ante alg√∫n est√≠mulo se denomina:", a: "ACTITUD"},
        {t: '2', q: "En el modelo de comportamiento de compra individual, ¬øla cultura es una variable...?", a: "VARIABLE EXTERNA"},
        {t: '2', q: "En el modelo de comportamiento de compra individual, ¬øel precio es una variable...?", a: "VARIABLE DE MARKETING"},
        {t: '2', q: "Los grupos de trabajo son:", a: "GRUPOS FORMALES PRIMARIOS"},
        {t: '2', q: "¬øA qu√© corresponde el rol del iniciador en la compra familiar?", a: "AL QUE INDICA LA NECESIDAD DE COMPRAR ALGO"},
        {t: '2', q: "¬øCu√°les son las diferencias de la compra industrial en relaci√≥n a la individual?", a: "√âNFASIS, COMPLEJIDAD Y TIPO DE RELACI√ìN CLIENTE-VENDEDOR"},
        {t: '2', q: "Conjunto de personas que necesitan un producto, desean comprarlo y tienen capacidad para hacerlo:", a: "MERCADO"},
        {t: '2', q: "¬øC√≥mo se clasifican los grupos de inter√©s en el modelo de agentes y fuerzas del entorno?", a: "MICROENTORNO"},
        {t: '2', q: "Seg√∫n las caracter√≠sticas de los compradores, los mercados se diferencian entre:", a: "MERCADO DE CONSUMO, INDUSTRIAL Y SERVICIOS"},
        {t: '2', q: "¬øEn qu√© problema de los servicios se encuentra el no poder transmitir la propiedad de los mismos?", a: "INTANGIBILIDAD"},
        {t: '2', q: "¬øEn qu√© problema de los servicios se emplea la medici√≥n de la satisfacci√≥n de los clientes para evitarlo?", a: "HETEROGENEIDAD"},
        {t: '2', q: "¬øLa implicaci√≥n del cliente en la producci√≥n y la calidad final del servicio qu√© problema origina?", a: "INSEPARABILIDAD"},
        {t: '2', q: "¬øC√≥mo se denomina el modelo de localizaci√≥n que determina el l√≠mite del √°rea comercial?", a: "CONVERSE"},
        {t: '2', q: "¬øQui√©n formul√≥ el modelo probabil√≠stico de comportamiento espacial?", a: "HUFF"},
        {t: '3', q: "¬øQu√© dimensi√≥n de la segmentaci√≥n aplica t√©cnicas estad√≠sticas para determinar grupos de clientes?", a: "ANAL√çTICA"},
        {t: '3', q: "Si se detecta un nuevo segmento y la competencia no lo ha identificado, ¬øes siempre conveniente desarrollar una estrategia centrada en √©l?", a: "NO, DEPENDE"},
        {t: '3', q: "La macrosegmentaci√≥n se equipara en las grandes corporaciones a las:", a: "UNIDADES ESTRAT√âGICAS DE NEGOCIO"},
        {t: '3', q: "¬øEn qu√© consiste la metodolog√≠a de la segmentaci√≥n a priori?", a: "DETERMINAR CON ANTERIORIDAD LOS SEGMENTOS Y LUEGO ANALIZARLOS"},
        {t: '3', q: "¬øEl posicionamiento competitivo es anterior o posterior al proceso de segmentaci√≥n?", a: "POSTERIOR"},
        {t: '3', q: "¬øProcedimiento de divisi√≥n del mercado donde algunas personas pueden no clasificarse en ning√∫n grupo?", a: "TIPOLOG√çA"},
        {t: '3', q: "¬øC√≥mo se clasifica la dimensi√≥n estilo de vida para la segmentaci√≥n?", a: "GENERAL - SUBJETIVA"},
        {t: '3', q: "Volumen total, f√≠sico o monetario adquirido por un grupo de compradores en lugar y periodo determinado:", a: "DEMANDA"},
        {t: '3', q: "Cifra de ventas que realiza el conjunto de empresas que opera en un determinado mercado:", a: "DEMANDA GLOBAL"},
        {t: '3', q: "Relaci√≥n entre las ventas de una marca y las ventas totales del mercado:", a: "CUOTA DE MERCADO"},
        {t: '3', q: "Diferencia entre las ventas totales actuales y el mercado potencial absoluto:", a: "EXPANSIBILIDAD DE LA DEMANDA"},
        {t: '3', q: "¬øVariables controlables por las empresas que influyen en la demanda?", a: "PRODUCTO, PRECIO, DISTRIBUCI√ìN Y COMUNICACI√ìN"},
        {t: '3', q: "Procedimiento de multiplicaci√≥n de sucesivos porcentajes para estimar el mercado potencial:", a: "RATIOS EN CADENA"},
        {t: '3', q: "En el modelo de Markov, ¬øqu√© probabilidades determinan el nivel de fidelidad?", a: "LAS DE LA DIAGONAL PRINCIPAL"},
        {t: '3', q: "¬øC√≥mo se calcula la situaci√≥n de equilibrio en el modelo de Markov?", a: "HACIENDO LAS CUOTAS DE MERCADO CONSTANTES"},
        {t: '3', q: "¬øQu√© m√©todo de previsi√≥n de demanda se emplea para largo plazo?", a: "DELPHI"},
        {t: '3', q: "Si hay grandes fluctuaciones hist√≥ricas, ¬øqu√© m√©todo a corto plazo NO se puede emplear?", a: "AJUSTE DE FUNCIONES"},
        {t: '3', q: "¬øQu√© tipo de oscilaci√≥n analiza el componente estacional?", a: "LAS DE UN PER√çODO INFERIOR AL A√ëO"},
        {t: '3', q: "Si hay un incremento significativo de demanda en los 2 √∫ltimos periodos, ¬øqu√© m√©todo emplear?", a: "BANDA DE ALISADO 3 O COEFICIENTE TENDENTE A 1"},
        {t: '4', q: "¬øUna idea puede ser considerada como un producto en marketing?", a: "S√ç"},
        {t: '4', q: "¬øEnfoque de marketing centrado en las caracter√≠sticas de los productos?", a: "MIOP√çA DE MARKETING"},
        {t: '4', q: "En el concepto de producto de Kotler, la calidad es un aspecto:", a: "FORMAL"},
        {t: '4', q: "¬øEn qu√© etapa del ciclo de vida se consigue el m√°ximo beneficio?", a: "CRECIMIENTO"},
        {t: '4', q: "¬øEn qu√© etapa del ciclo de vida se consiguen las m√°ximas ventas?", a: "MADUREZ"},
        {t: '4', q: "¬øEn qu√© etapa del ciclo de vida se encuentra la Wii (seg√∫n el temario)?", a: "CRECIMIENTO"},
        {t: '4', q: "¬øEn qu√© etapa se comienzan a reducir los m√°rgenes comerciales?", a: "MADUREZ"},
        {t: '4', q: "¬øCu√°ndo es conveniente aplicar la estrategia de relanzamiento?", a: "MADUREZ"},
        {t: '4', q: "Conjunto de l√≠neas de productos que comercializa una empresa:", a: "CARTERA DE PRODUCTOS"},
        {t: '4', q: "Estrategia de lanzar una nueva marca diferente con precio y calidad inferior:", a: "SEGUNDA MARCA"},
        {t: '4', q: "Grupo de productos estrechamente relacionados (mismas funciones, clientes, canales):", a: "L√çNEA DE PRODUCTOS"},
        {t: '4', q: "La amplitud de una cartera hace referencia al n√∫mero de:", a: "L√çNEAS DE PRODUCTOS"},
        {t: '4', q: "La profundidad de una cartera hace referencia al n√∫mero de:", a: "REFERENCIAS"},
        {t: '4', q: "Los componentes de una marca son:", a: "NOMBRE Y LOGOTIPO"},
        {t: '4', q: "Las marcas blancas son una estrategia de marca de:", a: "DISTRIBUIDOR"},
        {t: '4', q: "Caracter√≠sticas de comunicador, diferenciador, promotor y protector hacen referencia al:", a: "ENVASE"},
        {t: '4', q: "Estrategia de resaltar caracter√≠sticas para ser percibido como √∫nico:", a: "DIFERENCIACI√ìN"},
        {t: '4', q: "Forma, aspecto y color del producto que permite identificarlo:", a: "DISE√ëO"},
        {t: '4', q: "El c√≥digo de barras es un elemento que se encuentra en:", a: "ETIQUETA"},
        {t: '4', q: "¬øQu√© aspecto del producto hay que dise√±ar para reducir costes en log√≠stica?", a: "ENVASE"},
        {t: '5', q: "Para el comprador el precio es el ______ que da a cambio de la utilidad.", a: "VALOR"},
        {t: '5', q: "Para la empresa el precio es un instrumento a ______ plazo.", a: "CORTO"},
        {t: '5', q: "Grupos de inter√©s afectados por el precio (adem√°s de clientes):", a: "PROVEEDORES, ACCIONISTAS, COMPETIDORES"},
        {t: '5', q: "M√©todo de fijar precios analizando otras marcas:", a: "COMPETENCIA"},
        {t: '5', q: "M√©todo de fijar precios que analiza a los consumidores:", a: "VALOR PERCIBIDO"},
        {t: '5', q: "M√©todo de fijar precios considerado objetivo y justo:", a: "BASADO EN EL COSTE"},
        {t: '5', q: "¬øQu√© hay que determinar para fijar el precio objetivo?", a: "PUNTO MUERTO"},
        {t: '5', q: "¬øF√≥rmula del Punto Muerto (Ingresos y Costes)?", a: "IT = CT"},
        {t: '5', q: "Lanzar nuevo producto con precio muy competitivo para captar muchos clientes:", a: "PENETRACI√ìN"},
        {t: '5', q: "Lanzar nuevo producto con gran innovaci√≥n y precio elevado:", a: "DESCREMACI√ìN"},
        {t: '5', q: "Si cargo 25% de margen sobre precio de venta, ¬øa qu√© margen sobre coste equivale?", a: "33,33%"},
        {t: '5', q: "F√≥rmula margen comercial sobre precio de coste:", a: "MC/PC"},
        {t: '5', q: "Estrategia de vender marca de gran volumen bajo coste para captar ventas en otros productos:", a: "L√çDER EN P√âRDIDAS"},
        {t: '6', q: "Describa un canal de distribuci√≥n directo:", a: "FABRICANTE - CONSUMIDOR FINAL"},
        {t: '6', q: "Describa un canal de distribuci√≥n indirecto corto:", a: "FABRICANTE - MINORISTA - CONSUMIDOR FINAL"},
        {t: '6', q: "Describa un canal de distribuci√≥n indirecto largo:", a: "FABRICANTE - MAYORISTA - MINORISTA - CONSUMIDOR FINAL"},
        {t: '6', q: "Funci√≥n del canal donde se distribuyen cargas de stocks y p√©rdidas por caducidad:", a: "ASUNCI√ìN DE RIESGOS"},
        {t: '6', q: "Acci√≥n de ventas a intermediarios para que vendan la marca (Estrategia):", a: "PUSH - EMPUJAR"},
        {t: '6', q: "Acci√≥n promocional a consumidores finales para que demanden la marca (Estrategia):", a: "PULL - ASPIRACI√ìN"},
        {t: '6', q: "Promedio de veces que se llena y vac√≠a de stocks un almac√©n:", a: "ROTACI√ìN DE STOCKS"},
        {t: '6', q: "El tipo de servicio post-venta que requiere un producto determina:", a: "EL DISE√ëO DEL CANAL DE DISTRIBUCI√ìN"},
        {t: '6', q: "Estrategia con n√∫mero limitado de puntos de venta:", a: "SELECTIVA"},
        {t: '6', q: "Estrategia de vender en el mayor n√∫mero de establecimientos posible:", a: "INTENSIVA"},
        {t: '6', q: "Acuerdo donde fabricante cede marca y comercializaci√≥n en exclusiva:", a: "FRANQUICIA"},
        {t: '6', q: "¬øUn intermediario mayorista le puede vender a otro mayorista?", a: "S√ç"},
        {t: '6', q: "Actividades del detallista para estimular compra en punto de venta:", a: "MERCHANDISING"},
        {t: '6', q: "Deformaciones en el proceso de comunicaci√≥n en la comprensi√≥n de mensajes:", a: "RUIDO"},
        {t: '6', q: "¬øCu√°l es el MIX de la comunicaci√≥n?", a: "PUBLICIDAD, PROMOCI√ìN DE VENTAS, FUERZA DE VENTAS, RELACIONES P√öBLICAS Y MARKETING DIRECTO"},
        {t: '6', q: "Fines b√°sicos de la comunicaci√≥n:", a: "INFORMAR, PERSUADIR Y RECORDAR"},
        {t: '6', q: "Variable del mix de comunicaci√≥n m√°s impersonal:", a: "PUBLICIDAD"},
        {t: '6', q: "Variable del mix de comunicaci√≥n m√°s personal:", a: "LA FUERZA DE VENTAS"},
        {t: '6', q: "Comunicaci√≥n directa, impersonal e interactiva por medios convencionales/tecnol√≥gicos:", a: "MARKETING DIRECTO"},
        {t: '6', q: "Variable de comunicaci√≥n donde NO se paga a los medios:", a: "RELACIONES P√öBLICAS"}
    ];

    let currentQuestions = [];
    let currentIndex = 0;
    let score = 0;
    let currentTopicName = "";

    document.getElementById("user-input").addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
            if (document.getElementById("btn-action").style.display !== "none") {
                checkAnswer();
            } else {
                nextQuestion();
            }
        }
    });

    // --- NUEVAS FUNCIONES PARA MODO PERSONALIZADO ---

    function openCustomMenu() {
        document.getElementById('start-screen').classList.add('hidden');
        document.getElementById('custom-screen').classList.remove('hidden');

        // Escaneamos la base de datos para ver qu√© temas existen
        // Filtramos 'fijas' para que no salga, solo temas num√©ricos
        const uniqueTopics = [...new Set(database.map(item => item.t))].filter(t => t !== 'fijas').sort();
        
        const container = document.getElementById('topics-container');
        container.innerHTML = '';

        uniqueTopics.forEach(topic => {
            let labelText = "Tema " + topic;
            if (topic === '6') labelText = "Temas 6 y 7"; // Ajuste est√©tico
            
            const wrapper = document.createElement('div');
            wrapper.innerHTML = `
                <input type="checkbox" id="check-${topic}" class="topic-check" value="${topic}">
                <label for="check-${topic}" class="topic-label">
                    ‚úÖ ${labelText}
                </label>
            `;
            container.appendChild(wrapper);
        });
    }

    function closeCustomMenu() {
        document.getElementById('custom-screen').classList.add('hidden');
        document.getElementById('start-screen').classList.remove('hidden');
    }

    function startCustomExam() {
        const checkedBoxes = document.querySelectorAll('.topic-check:checked');
        
        if (checkedBoxes.length === 0) {
            alert("¬°Selecciona al menos un tema, bro!");
            return;
        }

        const selectedTopics = Array.from(checkedBoxes).map(cb => cb.value);

        // Filtramos preguntas que coincidan con CUALQUIERA de los temas seleccionados
        let pool = database.filter(item => selectedTopics.includes(item.t));

        if (pool.length === 0) {
            alert("Error: No se encontraron preguntas para estos temas.");
            return;
        }

        currentTopicName = "PERSONALIZADO (" + selectedTopics.join(', ') + ")";
        
        // Barajamos
        let shuffled = pool.sort(() => 0.5 - Math.random());
        
        // Seleccionamos max 20
        currentQuestions = shuffled.slice(0, 20);
        
        currentIndex = 0;
        score = 0;
        
        document.getElementById('custom-screen').classList.add('hidden');
        document.getElementById('quiz-screen').classList.remove('hidden');
        
        loadQuestion();
    }

    // --- FIN FUNCIONES NUEVAS ---

    function returnToMenu() {
        document.getElementById('quiz-screen').classList.add('hidden');
        document.getElementById('result-screen').classList.add('hidden');
        document.getElementById('custom-screen').classList.add('hidden'); // Aseguramos ocultar este tambi√©n
        document.getElementById('start-screen').classList.remove('hidden');
    }

    function startExam(topic) {
        let pool = [];
        
        if (topic === 'all') {
            pool = database.filter(item => item.t !== 'fijas');
            currentTopicName = "EXAMEN GENERAL";
        } else if (topic === 'fijas') {
            pool = database.filter(item => item.t === 'fijas');
            currentTopicName = "üî• PREGUNTAS FIJAS";
        } else {
            pool = database.filter(item => item.t === topic);
            currentTopicName = "TEMA " + topic;
            if(topic === '6') currentTopicName = "TEMAS 6 Y 7";
        }
        
        if (pool.length === 0) {
            alert("No hay preguntas en este tema todav√≠a.");
            return;
        }

        let shuffled = pool.sort(() => 0.5 - Math.random());
        currentQuestions = shuffled.slice(0, 20);
        
        currentIndex = 0;
        score = 0;
        
        document.getElementById('start-screen').classList.add('hidden');
        document.getElementById('result-screen').classList.add('hidden');
        document.getElementById('quiz-screen').classList.remove('hidden');
        
        loadQuestion();
    }

    function loadQuestion() {
        document.getElementById('progress-text').innerText = `${currentTopicName} | Pregunta ${currentIndex + 1} de ${currentQuestions.length}`;
        document.getElementById('question-text').innerText = currentQuestions[currentIndex].q;
        
        let input = document.getElementById('user-input');
        input.value = '';
        input.disabled = false;
        input.focus();
        
        document.getElementById('feedback-box').style.display = 'none';
        document.getElementById('feedback-box').className = 'feedback';
        document.getElementById('btn-next').style.display = 'none';
        document.getElementById('btn-action').style.display = 'inline-block';
    }

    function cleanString(str) {
        return str.toLowerCase()
                  .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
                  .replace(/[\.,-]/g, " ")
                  .replace(/\s+/g, ' ')
                  .trim();
    }

    function checkAnswer() {
        let userAnswer = document.getElementById('user-input').value;
        let correctAnswer = currentQuestions[currentIndex].a;

        let cleanUser = cleanString(userAnswer);
        let cleanCorrect = cleanString(correctAnswer);
        let isCorrect = false;

        if (cleanUser === cleanCorrect) {
            isCorrect = true;
        } else if (cleanUser.length > 3 && cleanCorrect.includes(cleanUser)) {
             isCorrect = true;
        }

        let feedbackBox = document.getElementById('feedback-box');
        let feedbackMsg = document.getElementById('feedback-msg');
        let realAnswerMsg = document.getElementById('real-answer');

        if (isCorrect) {
            score++;
            feedbackBox.classList.add('correct');
            feedbackMsg.innerHTML = "<strong>¬°CORRECTO!</strong>";
            realAnswerMsg.innerText = "";
        } else {
            feedbackBox.classList.add('wrong');
            feedbackMsg.innerHTML = "<strong>INCORRECTO</strong>";
            realAnswerMsg.innerHTML = "La respuesta correcta era:<br>" + correctAnswer;
        }

        feedbackBox.style.display = 'block';
        
        document.getElementById('user-input').disabled = true;
        document.getElementById('btn-action').style.display = 'none';
        document.getElementById('btn-next').style.display = 'inline-block';
        document.getElementById('btn-next').focus();
    }

    function nextQuestion() {
        currentIndex++;
        if (currentIndex < currentQuestions.length) {
            loadQuestion();
        } else {
            showResults();
        }
    }

    function showResults() {
        document.getElementById('quiz-screen').classList.add('hidden');
        document.getElementById('result-screen').classList.remove('hidden');
        
        let display = document.getElementById('score-display');
        let msg = document.getElementById('message-display');
        
        display.innerText = `${score} / ${currentQuestions.length}`;
        
        let percentage = (score / currentQuestions.length) * 10;
        
        if (percentage >= 9) {
            display.style.color = '#27ae60';
            msg.innerText = "Sacada bro";
        } else if (percentage >= 5) {
            display.style.color = '#f39c12';
            msg.innerText = "Aprobado.";
        } else {
            display.style.color = '#c0392b';
            msg.innerText = "Espabila.";
        }
    }
</script>

</body>
</html>